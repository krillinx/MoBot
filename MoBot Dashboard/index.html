<!DOCTYPE html>
<head>
  <link href="https://fonts.googleapis.com/css?family=Hind&display=swap" rel="stylesheet">

  <style>
    body {
      background-color: #36393f;
      font-family: 'Hind', sans-serif;
    }
    #inputs {
      text-align: right;
      width: auto;
    }
    .embed {
      background-color: #33353c;

      border-style: solid;
      border-color: #303237;
      border-left-color: #4f545c;
      padding-left: 4px;
      padding-right: 12px;
      font-size: 14px;
    }
    .table {
      color: white;
    }
    #authorOut {
      font-weight: bold;
      color: #fff2e6;
    }
    #descriptionOut #footerOut {
      color: #a5a09d;
    }
    #footerOut {
      font-size: 12px;
    }
  </style>
</head>
<body>
  <table class="table">
    <tr>
      <td style="text-align: center">
        Inputs
      </td>
      <td style="text-align: center">
        Output
      </td>
    </tr>
    <tr>
      <td>
        <fieldSet id=inputs>
          Color:
          <input id="colorIn" type="text" onchange="setFocus(this)"><br>
          Header:
          <input id="authorIn" type="text" onchange="setFocus(this)"><br>
          Description:
          <input id="descriptionIn" type="text" onchange="setFocus(this)"><br>
          Footer:
          <input id="footerIn" type="text" onchange="setFocus(this)">

        </fieldSet>
      </td>
      <td>
        <fieldset>
          <p class="embed">
            <span id="authorOut"></span><br>
            <span id="descriptionOut"></span><br>
            <span id="footerOut"></span>
          </p>
        </fieldset>
      </td>
    </tr>
    <tr>
      <td style="text-align: center">
        Command
      </td>
    </tr>
    <tr>
      <td>
        <fieldset>
          <p id=MoBotInput>@MoBot#0697 say embed </p>
          <input type="image" src="https://img.icons8.com/ios-glyphs/30/000000/copy.png"/ onclick='copyToClipboard("MoBotInput")'>
        </fieldset>
      </td>
    </tr>
  </table>

  <script>

    inputs = []
    inputs.push(document.getElementById("colorIn"))
    inputs.push(document.getElementById("authorIn"))
    inputs.push(document.getElementById("descriptionIn"))
    inputs.push(document.getElementById("footerIn"))

    nonTextElements = ["colorIn"]

    function set(element, text) {
      while (element.firstChild) {
        element.removeChild(element.firstChild);
      }
      element.appendChild(document.createTextNode(text))
    } // end set

    function setEmbedColor(element, selector) {
      let elements = document.querySelectorAll(selector);

      color = "#" + element.value
      for (let i = 0; i < elements.length; i++) {
        elements[i].style.borderLeftColor = color
      }
    } // end setEmbedColor

    function setCommandInput(inputs) {
    } // end setCommandInput

    function setupUpdater(element) {
      id = element.id.split("In")[0] + "Out"
      var input = element
        , output = document.getElementById(id)
        , moBotInput = document.getElementById("MoBotInput")
        , oldText = ""
        , timeout=null;

      function update() {
        var newText = input.value
        if (newText == oldText) {
          return;
        } else {
          oldText = newText;
        }
        if (nonTextElements.includes(element.id)) {
          if (element.id == "colorIn") {
            setEmbedColor(element, ".embed");
          }
        } else {
          set(output, newText)
        }

      } // end update

      function eventHandler() {
        if (timeout) {
          clearTimeout(timeout);
        }
        timeout=setTimeout(update, 50);
      } // end eventHandler

      input.onkeydown=input.onkeyup=input.onclick=input.onchange=eventHandler;
    } // end setupUpdater

    function setFocus(element) {
      setupUpdater(element)
    } // end setFocus

    function copyToClipboard(id) {
      var text = document.getElementById(id).innerText;
      var elem = document.createElement("textarea");
      document.body.appendChild(elem);
      elem.value = text;
      elem.select();
      document.execCommand("copy");
      document.body.removeChild(elem);
    } //end copyToClipboard

  </script>
</body>